<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‰æ²¿æŒ‡æŒ¥æ‰€</title>
    <link rel="stylesheet" href="styles.css">

</head>

<body>
    <button class="back-to-top">â†‘</button>
    <button class="theme-toggle">åˆ‡æ¢ä¸»é¢˜</button>

    <div class="container">
        <div class="game-header">
            <h1 class="game-title">è¯¦æƒ…ä»‹ç»</h1>
            <p class="game-subtitle">RPGç¾äººè®¡å¯¹ç­–åŠå…¬å®¤1.0æ±‰åŒ–ç‰ˆã€PC+å®‰å“347MBã€‘</p>
        </div>

        <div class="main-image">
            <img id="mainImage" src="" alt="æ¸¸æˆä¸»å›¾">
        </div>

        <div class="game-stats">
            <div class="stat-item" onclick="openRatingModal()">
                <div class="stat-icon">â­</div>
                <div class="stat-value" id="ratingValue">4.8</div>
                <div class="stat-label">è¯„åˆ†</div>
            </div>
            <div class="stat-item">
                <div class="stat-icon">ğŸ“¥</div>
                <div class="stat-value">12.5K</div>
                <div class="stat-label">ä¸‹è½½</div>
            </div>
            <div class="stat-item">
                <div class="stat-icon">â¤ï¸</div>
                <div class="stat-value">3.2K</div>
                <div class="stat-label">æ”¶è—</div>
            </div>
            <div class="stat-item" onclick="openForum()">
                <div class="stat-icon">ğŸ’¬</div>
                <div class="stat-value" id="commentCount">0</div>
                <div class="stat-label">è¯„è®º</div>
            </div>
        </div>

        <div class="action-buttons">
            <button class="action-button" onclick="startGame()">å¼€å§‹æ¸¸æˆ</button>
            <a href="" class="action-button download">ä¸‹è½½æ¸¸æˆ</a>
            <a href="https://qm.qq.com/q/IekbXKmPAG" class="action-button service">è”ç³»å®¢æœ</a>
        </div>

        <div class="info-card">
            <h3>æ¸¸æˆæ•…äº‹</h3>
            <p class="story-text">
                æˆ‘ä»¬çš„å›½å®¶æ­£ç»å†ç€é€šè¿‡é—´è°æ´»åŠ¨ä¸æ–­çªƒå–ä¿¡æ¯å’Œæœºå¯†çš„äº‹ä»¶ã€‚æŸä¸ªå›½å®¶æœ€çˆ±ç”¨çš„ä¼ä¿©å°±æ˜¯æ€§æ„Ÿç¾äººè®¡ã€‚å› æ­¤ï¼Œä¸€ä¸ªç§˜å¯†ç»„ç»‡æˆç«‹äº†ï¼Œä»¥æ‰“å‡»ç¾äººè®¡ï¼
            </p>
        </div>

        <div class="image-gallery">
            <span class="gallery-close">&times;</span>
            <button class="gallery-nav prev">&lt;</button>
            <button class="gallery-nav next">&gt;</button>
            <img class="gallery-image" src="" alt="Gallery Image">
            <div class="dialogue-box">
                <p class="dialogue-text"></p>
            </div>
        </div>

        <div class="image-container" id="image-container"></div>

        <div class="info-card">
            <h3>æ›´æ–°æ—¥å¿—</h3>
            <div class="changelog-item">
                <h4>v1.04æ›´æ–°è¯´æ˜</h4>
                <ul>
                    <li>ä¿®å¤å†…å®¹è£…å¤‡å±æ€§é™åˆ¶å¼‚å¸¸ä¿®æ­£</li>
                    <li>è°ƒæ•´åçš„é™åˆ¶æ ‡å‡†ä¸åŸå…ˆå‡ ä¹ä¿æŒç›¸åŒå¹³è¡¡æ€§</li>
                    <li>è°ƒæ•´äº†éƒ¨åˆ†å±æ€§é™åˆ¶è£…å¤‡çš„åˆ¤å®šæ¡ä»¶</li>
                    <li>ä¿®å¤äº†æŸäº›æƒ…å†µä¸‹é™åˆ¶æœªç”Ÿæ•ˆçš„BUG</li>
                    <li>å¤šå‘¨ç›®ã€Œæ°´æ™¶ã€è®°å¿†é‡ç½®ä¼˜åŒ–</li>
                    <li>å¤šå‘¨ç›®æ•°æ®æ®‹ç•™é—®é¢˜ä¿®å¤</li>
                </ul>
            </div>
        </div>

        <div class="installation-guide">
            <h3>å®‰è£…æŒ‡å—</h3>
            <div class="guide-step">
                <h4 onclick="toggleGuide(this)">PCç‰ˆæœ¬å®‰è£…æ­¥éª¤</h4>
                <div class="guide-content">
                    <p>1. ä¸‹è½½æ¸¸æˆå‹ç¼©åŒ…å¹¶è§£å‹åˆ°ä»»æ„ç›®å½•</p>
                    <p>2. è¿è¡Œæ¸¸æˆä¸»ç¨‹åºå³å¯å¼€å§‹æ¸¸æˆ</p>
                    <p>3. å¦‚é‡åˆ°è¿è¡Œé—®é¢˜ï¼Œè¯·ç¡®ä¿å·²å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„DirectXå’ŒVisual C++è¿è¡Œåº“</p>
                </div>
            </div>
            <div class="guide-step">
                <h4 onclick="toggleGuide(this)">å®‰å“ç‰ˆæœ¬å®‰è£…æ­¥éª¤</h4>
                <div class="guide-content">
                    <p>1. ä¸‹è½½APKå®‰è£…åŒ…</p>
                    <p>2. åœ¨æ‰‹æœºè®¾ç½®ä¸­å…è®¸å®‰è£…æœªçŸ¥æ¥æºåº”ç”¨</p>
                    <p>3. ç‚¹å‡»APKæ–‡ä»¶è¿›è¡Œå®‰è£…</p>
                    <p>4. å®‰è£…å®Œæˆåç‚¹å‡»å›¾æ ‡å³å¯å¼€å§‹æ¸¸æˆ</p>
                </div>
            </div>
            <div class="guide-step">
                <h4 onclick="toggleGuide(this)">æ³¨æ„äº‹é¡¹</h4>
                <div class="guide-content">
                    <p>â€¢ æ¸¸æˆéœ€è¦è‡³å°‘2GBå¯ç”¨å­˜å‚¨ç©ºé—´</p>
                    <p>â€¢ å®‰å“è®¾å¤‡éœ€è¦Android 5.0æˆ–æ›´é«˜ç‰ˆæœ¬</p>
                    <p>â€¢ å¦‚é‡åˆ°å®‰è£…é—®é¢˜ï¼Œè¯·å°è¯•é‡å¯è®¾å¤‡åé‡æ–°å®‰è£…</p>
                </div>
            </div>
        </div>

        <div class="info-card">
            <h3>ç›¸å…³æ¨è</h3>
            <div class="games-grid">
                <a href="../xiangguantuijian/xiangguantuijian1.html" class="game-card">
                    <img src="../xiangguantuijian/imgae/6.jpg" alt="å‚¬çœ æ¸¸æˆ">
                    <div class="game-info">
                        <h4>å‚¬çœ æ¸¸æˆ</h4>
                        <p>å‚¬çœ é¢˜æï¼Œå‰§æƒ…ä¸°å¯Œ</p>
                    </div>
                </a>
                <a href="../xiangguantuijian/xiangguantuijian2.html" class="game-card">
                    <img src="../xiangguantuijian/imgae/2.jpg" alt="è°ƒæ•™æ¸¸æˆ">
                    <div class="game-info">
                        <h4>è°ƒæ•™æ¸¸æˆ</h4>
                        <p>è°ƒæ•™ç©æ³•ï¼Œå¤šç§ç»“å±€</p>
                    </div>
                </a>
                <a href="../xiangguantuijian/xiangguantuijian3.html" class="game-card">
                    <img src="../xiangguantuijian/imgae/3.jpg" alt="SMæ¸¸æˆ">
                    <div class="game-info">
                        <h4>SMæ¸¸æˆ</h4>
                        <p>SMç©æ³•ï¼Œå‰§æƒ…ä¸°å¯Œ</p>
                    </div>
                </a>
            </div>
        </div>

        <div class="rating-modal" id="ratingModal">
            <div class="rating-content">
                <h3>ä¸ºæ¸¸æˆè¯„åˆ†</h3>
                <div class="rating-stars">
                    <span class="rating-star" data-value="1">â˜…</span>
                    <span class="rating-star" data-value="2">â˜…</span>
                    <span class="rating-star" data-value="3">â˜…</span>
                    <span class="rating-star" data-value="4">â˜…</span>
                    <span class="rating-star" data-value="5">â˜…</span>
                </div>
                <button class="rating-submit" onclick="submitRating()">æäº¤è¯„åˆ†</button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        const imageFolderPath = '../image2/RPGç¾äººè®¡å¯¹ç­–åŠå…¬å®¤1.0æ±‰åŒ–ç‰ˆã€PC+å®‰å“347MBã€‘/';
        const totalImages = 7;
        let currentGalleryIndex = 0;
        let galleryImages = [];
        let isGalleryOpen = false;

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', function () {
            initializePage();
            setupEventListeners();
            loadImages();
            setupTheme();
        });

        // åˆå§‹åŒ–é¡µé¢
        function initializePage() {
            // è®¾ç½®ä¸»å›¾
            const mainImage = document.getElementById('mainImage');
            mainImage.src = `${imageFolderPath}1.jpg`;
            galleryImages = [mainImage.src];

            // åˆå§‹åŒ–å›¾ç‰‡å®¹å™¨
            const imageContainer = document.getElementById('image-container');
            imageContainer.innerHTML = '';

            // åŠ è½½å‰6å¼ æè¿°å›¾
            for (let i = 0; i < 6; i++) {
                const imgElement = createImageElement(i + 2);
                imageContainer.appendChild(imgElement);
                galleryImages.push(imgElement.querySelector('img').src);
            }
        }

        // åˆ›å»ºå›¾ç‰‡å…ƒç´ 
        function createImageElement(index) {
            const div = document.createElement('div');
            div.className = 'image-item';
            const img = document.createElement('img');
            img.src = `${imageFolderPath}${index}.jpg`;
            img.alt = `æ¸¸æˆæˆªå›¾ ${index}`;
            img.loading = 'lazy';
            div.appendChild(img);
            return div;
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // è¿”å›é¡¶éƒ¨æŒ‰é’®
            const backToTop = document.querySelector('.back-to-top');
            window.addEventListener('scroll', () => {
                backToTop.style.display = window.scrollY > 300 ? 'block' : 'none';
            });
            backToTop.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            // ä¸»é¢˜åˆ‡æ¢
            const themeToggle = document.querySelector('.theme-toggle');
            themeToggle.addEventListener('click', toggleTheme);

            // å›¾ç‰‡ç”»å»Š
            setupGalleryEvents();

            // å®‰è£…æŒ‡å—å±•å¼€/æ”¶èµ·
            setupInstallationGuide();

            // æ ‡ç­¾ç‚¹å‡»
            setupTags();
        }

        // è®¾ç½®å›¾ç‰‡ç”»å»Šäº‹ä»¶
        function setupGalleryEvents() {
            const gallery = document.querySelector('.image-gallery');
            const closeBtn = document.querySelector('.gallery-close');
            const prevBtn = document.querySelector('.gallery-nav.prev');
            const nextBtn = document.querySelector('.gallery-nav.next');

            // å…³é—­ç”»å»Š
            closeBtn.addEventListener('click', () => {
                gallery.style.display = 'none';
                isGalleryOpen = false;
                document.body.style.overflow = 'auto';
            });

            // ä¸Šä¸€å¼ /ä¸‹ä¸€å¼ 
            prevBtn.addEventListener('click', () => navigateGallery(-1));
            nextBtn.addEventListener('click', () => navigateGallery(1));

            // é”®ç›˜å¯¼èˆª
            document.addEventListener('keydown', (e) => {
                if (!isGalleryOpen) return;
                switch (e.key) {
                    case 'ArrowLeft':
                        navigateGallery(-1);
                        break;
                    case 'ArrowRight':
                        navigateGallery(1);
                        break;
                    case 'Escape':
                        gallery.style.display = 'none';
                        isGalleryOpen = false;
                        document.body.style.overflow = 'auto';
                        break;
                }
            });

            // ç‚¹å‡»å›¾ç‰‡æ‰“å¼€ç”»å»Š
            document.querySelectorAll('.image-item img, #mainImage').forEach((img, index) => {
                img.addEventListener('click', () => openGallery(index));
            });
        }

        // è®¾ç½®å®‰è£…æŒ‡å—å±•å¼€/æ”¶èµ·
        function setupInstallationGuide() {
            const steps = document.querySelectorAll('.guide-step');

            steps.forEach(step => {
                const header = step.querySelector('h4');
                const content = step.querySelector('.guide-content');

                header.addEventListener('click', () => {
                    // å…³é—­å…¶ä»–æ‰€æœ‰æ­¥éª¤
                    steps.forEach(otherStep => {
                        if (otherStep !== step) {
                            const otherContent = otherStep.querySelector('.guide-content');
                            otherContent.style.display = 'none';
                        }
                    });

                    // åˆ‡æ¢å½“å‰æ­¥éª¤
                    const isActive = step.classList.contains('active');
                    step.classList.toggle('active');
                    content.style.display = isActive ? 'none' : 'block';
                });
            });
        }

        // è®¾ç½®æ ‡ç­¾ç‚¹å‡»äº‹ä»¶
        function setupTags() {
            document.querySelectorAll('.game-tag').forEach(tag => {
                tag.addEventListener('click', () => {
                    tag.classList.toggle('active');
                });
            });
        }

        // æ‰“å¼€å›¾ç‰‡ç”»å»Š
        function openGallery(index) {
            const gallery = document.querySelector('.image-gallery');
            const galleryImg = document.querySelector('.gallery-image');
            const dialogueText = document.querySelector('.dialogue-text');

            if (index >= 0 && index < galleryImages.length) {
                currentGalleryIndex = index;
                gallery.style.display = 'flex';
                galleryImg.src = galleryImages[index];
                dialogueText.textContent = getRandomDialogue();
                isGalleryOpen = true;
                document.body.style.overflow = 'hidden';
            }
        }

        // å¯¼èˆªç”»å»Š
        function navigateGallery(direction) {
            currentGalleryIndex = (currentGalleryIndex + direction + galleryImages.length) % galleryImages.length;
            const galleryImg = document.querySelector('.gallery-image');
            const dialogueText = document.querySelector('.dialogue-text');

            galleryImg.src = galleryImages[currentGalleryIndex];
            dialogueText.textContent = getRandomDialogue();
        }

        // è·å–éšæœºå¯¹è¯
        function getRandomDialogue() {
            const dialogues = [
                "ä¸»äºº...äººå®¶çš„ä¸‹é¢å¥½æ¹¿...å¥½æƒ³è¦ä¸»äººçš„å¤§è‚‰æ£’...",
                "å•Š...ä¸»äººçš„æ‰‹æŒ‡å¥½å‰å®³...äººå®¶çš„å°ç©´å¥½èˆ’æœ...",
                "ä¸»äºº...äººå®¶çš„å¥¶å­å¥½æ¶¨...è¯·ç”¨åŠ›æ‰æå®ƒä»¬...",
                "å•Š...ä¸»äººçš„èˆŒå¤´å¥½çµæ´»...äººå®¶çš„ä¹³å¤´å¥½æ•æ„Ÿ...",
                "ä¸»äºº...äººå®¶çš„å±è‚¡å¥½ç—’...è¯·ç”¨åŠ›æ‹æ‰“å®ƒ...",
                "å•Š...ä¸»äººçš„è‚‰æ£’å¥½å¤§...äººå®¶çš„å°ç©´å¥½ç´§...",
                "ä¸»äºº...äººå®¶çš„æ·«æ°´å¥½å¤š...éƒ½æµå‡ºæ¥äº†...",
                "å•Š...ä¸»äººçš„æ‰‹æŒ‡å¥½æ·±...äººå®¶è¦é«˜æ½®äº†...",
                "ä¸»äºº...äººå®¶çš„å¥¶å¤´å¥½ç¡¬...è¯·ç»§ç»­ç©å¼„å®ƒä»¬...",
                "å•Š...ä¸»äººçš„èˆŒå¤´å¥½çƒ­...äººå®¶çš„é˜´è’‚å¥½èˆ’æœ...",
                "ä¸»äºº...äººå®¶çš„å±è‚¡å¥½çº¢...è¯·ç»§ç»­æ‰“å®ƒ...",
                "å•Š...ä¸»äººçš„è‚‰æ£’å¥½ç²—...äººå®¶çš„å°ç©´å¥½æ»¡...",
                "ä¸»äºº...äººå®¶çš„æ·«æ°´å¥½ç”œ...è¯·å°å°çœ‹...",
                "å•Š...ä¸»äººçš„æ‰‹æŒ‡å¥½å¿«...äººå®¶è¦å»äº†...",
                "ä¸»äºº...äººå®¶çš„å¥¶å­å¥½è½¯...è¯·ç”¨åŠ›æ‰å®ƒä»¬...",
                "å•Š...ä¸»äººçš„èˆŒå¤´å¥½æ¹¿...äººå®¶çš„ä¹³å¤´å¥½ç—’...",
                "ä¸»äºº...äººå®¶çš„å±è‚¡å¥½ç—›...ä½†æ˜¯å¥½èˆ’æœ...",
                "å•Š...ä¸»äººçš„è‚‰æ£’å¥½ç¡¬...äººå®¶çš„å°ç©´å¥½çƒ­...",
                "ä¸»äºº...äººå®¶çš„æ·«æ°´å¥½é¦™...è¯·å–æ‰å®ƒ...",
                "å•Š...ä¸»äººçš„æ‰‹æŒ‡å¥½çµæ´»...äººå®¶è¦é«˜æ½®äº†...",
                "ä¸»äºº...äººå®¶çš„å¥¶å¤´å¥½æ•æ„Ÿ...è¯·ç»§ç»­ç©å¼„...",
                "å•Š...ä¸»äººçš„èˆŒå¤´å¥½è½¯...äººå®¶çš„é˜´è’‚å¥½ç—’...",
                "ä¸»äºº...äººå®¶çš„å±è‚¡å¥½çƒ«...è¯·ç»§ç»­æ‰“å®ƒ...",
                "å•Š...ä¸»äººçš„è‚‰æ£’å¥½é•¿...äººå®¶çš„å°ç©´å¥½æ·±...",
                "ä¸»äºº...äººå®¶çš„æ·«æ°´å¥½æ»‘...è¯·ç»§ç»­ç©å¼„...",
                "å•Š...ä¸»äººçš„æ‰‹æŒ‡å¥½æ·±...äººå®¶è¦å»äº†...",
                "ä¸»äºº...äººå®¶çš„å¥¶å­å¥½å¤§...è¯·ç”¨åŠ›æ‰å®ƒä»¬...",
                "å•Š...ä¸»äººçš„èˆŒå¤´å¥½çƒ­...äººå®¶çš„ä¹³å¤´å¥½ç¡¬...",
                "ä¸»äºº...äººå®¶çš„å±è‚¡å¥½çº¢...è¯·ç»§ç»­æ‰“å®ƒ...",
                "å•Š...ä¸»äººçš„è‚‰æ£’å¥½ç²—...äººå®¶çš„å°ç©´å¥½ç´§...",
                "ä¸»äºº...äººå®¶çš„æ·«æ°´å¥½å¤š...éƒ½æµå‡ºæ¥äº†...",
                "å•Š...ä¸»äººçš„æ‰‹æŒ‡å¥½å¿«...äººå®¶è¦é«˜æ½®äº†...",
                "ä¸»äºº...äººå®¶çš„å¥¶å¤´å¥½ç¡¬...è¯·ç»§ç»­ç©å¼„å®ƒä»¬...",
                "å•Š...ä¸»äººçš„èˆŒå¤´å¥½æ¹¿...äººå®¶çš„é˜´è’‚å¥½èˆ’æœ...",
                "ä¸»äºº...äººå®¶çš„å±è‚¡å¥½ç—›...ä½†æ˜¯å¥½èˆ’æœ...",
                "å•Š...ä¸»äººçš„è‚‰æ£’å¥½ç¡¬...äººå®¶çš„å°ç©´å¥½çƒ­...",
                "ä¸»äºº...äººå®¶çš„æ·«æ°´å¥½ç”œ...è¯·å°å°çœ‹...",
                "å•Š...ä¸»äººçš„æ‰‹æŒ‡å¥½çµæ´»...äººå®¶è¦å»äº†...",
                "ä¸»äºº...äººå®¶çš„å¥¶å­å¥½è½¯...è¯·ç”¨åŠ›æ‰å®ƒä»¬...",
                "å•Š...ä¸»äººçš„èˆŒå¤´å¥½è½¯...äººå®¶çš„ä¹³å¤´å¥½ç—’...",
                "ä¸»äºº...äººå®¶çš„å±è‚¡å¥½çƒ«...è¯·ç»§ç»­æ‰“å®ƒ...",
                "å•Š...ä¸»äººçš„è‚‰æ£’å¥½é•¿...äººå®¶çš„å°ç©´å¥½æ·±...",
                "ä¸»äºº...äººå®¶çš„æ·«æ°´å¥½é¦™...è¯·å–æ‰å®ƒ...",
                "å•Š...ä¸»äººçš„æ‰‹æŒ‡å¥½æ·±...äººå®¶è¦é«˜æ½®äº†...",
                "ä¸»äºº...äººå®¶çš„å¥¶å¤´å¥½æ•æ„Ÿ...è¯·ç»§ç»­ç©å¼„...",
                "å•Š...ä¸»äººçš„èˆŒå¤´å¥½çƒ­...äººå®¶çš„é˜´è’‚å¥½ç—’...",
                "ä¸»äºº...äººå®¶çš„å±è‚¡å¥½çº¢...è¯·ç»§ç»­æ‰“å®ƒ...",
                "å•Š...ä¸»äººçš„è‚‰æ£’å¥½ç²—...äººå®¶çš„å°ç©´å¥½æ»¡...",
                "ä¸»äºº...äººå®¶çš„æ·«æ°´å¥½æ»‘...è¯·ç»§ç»­ç©å¼„...",
                "å•Š...ä¸»äººçš„æ‰‹æŒ‡å¥½å¿«...äººå®¶è¦å»äº†..."
            ];
            return dialogues[Math.floor(Math.random() * dialogues.length)];
        }

        // åˆ‡æ¢ä¸»é¢˜
        function toggleTheme() {
            const body = document.body;
            const isDarkMode = body.classList.contains('dark-mode');

            if (isDarkMode) {
                body.classList.remove('dark-mode');
                body.classList.add('light-mode');
                localStorage.setItem('theme', 'light');
                document.querySelector('.theme-toggle').textContent = 'åˆ‡æ¢æš—è‰²';
            } else {
                body.classList.remove('light-mode');
                body.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark');
                document.querySelector('.theme-toggle').textContent = 'åˆ‡æ¢äº®è‰²';
            }
        }

        // è®¾ç½®ä¸»é¢˜
        function setupTheme() {
            const body = document.body;
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const themeToggle = document.querySelector('.theme-toggle');

            if (savedTheme === 'light' || (!savedTheme && !prefersDark)) {
                body.classList.add('light-mode');
                themeToggle.textContent = 'åˆ‡æ¢æš—è‰²';
            } else {
                body.classList.add('dark-mode');
                themeToggle.textContent = 'åˆ‡æ¢äº®è‰²';
                document.body.classList.add('dark-mode');
                document.querySelector('.theme-toggle').textContent = 'åˆ‡æ¢äº®è‰²';
            }
        }

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            window.location.href = 'game_scene.html';
        }

        // åˆ†äº«æ¸¸æˆ
        function shareGame() {
            if (navigator.share) {
                navigator.share({
                    title: 'æ¸¸æˆè¯¦æƒ…',
                    text: 'æŸ¥çœ‹è¿™ä¸ªæœ‰è¶£çš„æ¸¸æˆï¼',
                    url: window.location.href
                }).catch(console.error);
            } else {
                navigator.clipboard.writeText(window.location.href)
                    .then(() => alert('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼'))
                    .catch(() => alert('å¤åˆ¶é“¾æ¥å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ã€‚'));
            }
        }

        function toggleGuide(element) {
            const step = element.parentElement;
            const content = element.nextElementSibling;
            const allSteps = document.querySelectorAll('.guide-step');

            // å…³é—­å…¶ä»–æ‰€æœ‰æ­¥éª¤
            allSteps.forEach(otherStep => {
                if (otherStep !== step) {
                    const otherContent = otherStep.querySelector('.guide-content');
                    otherContent.style.display = 'none';
                }
            });

            // åˆ‡æ¢å½“å‰æ­¥éª¤
            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
            } else {
                content.style.display = 'none';
            }
        }

        // æ”¶è—åŠŸèƒ½
        function toggleFavorite() {
            const favoriteBtn = document.querySelector('.stat-item:nth-child(3)');
            const isFavorited = localStorage.getItem('gameFavorited') === 'true';

            if (!isFavorited) {
                localStorage.setItem('gameFavorited', 'true');
                const count = parseInt(favoriteBtn.querySelector('.stat-value').textContent);
                favoriteBtn.querySelector('.stat-value').textContent = count + 1;
                favoriteBtn.querySelector('.stat-icon').textContent = 'â¤ï¸';
                alert('å·²æ·»åŠ åˆ°æ”¶è—ï¼');
            } else {
                alert('å·²ç»æ”¶è—è¿‡äº†ï¼');
            }
        }

        // æäº¤è¯„åˆ†
        function submitRating() {
            const isRated = localStorage.getItem('gameRated') === 'true';
            if (isRated) {
                alert('å·²ç»è¯„åˆ†è¿‡äº†ï¼');
                return;
            }

            const activeStars = document.querySelectorAll('.rating-star.active');
            const rating = activeStars.length;

            if (rating > 0) {
                // ä¿å­˜è¯„åˆ†çŠ¶æ€
                localStorage.setItem('gameRated', 'true');

                // ä¿å­˜è¯„åˆ†åˆ°localStorage
                localStorage.setItem('gameRating', rating);

                // æ›´æ–°æ˜¾ç¤ºçš„è¯„åˆ†
                const ratingValue = document.getElementById('ratingValue');
                const currentRating = parseFloat(ratingValue.textContent);
                const newRating = ((currentRating * 856) + rating) / 857; // å‡è®¾æœ‰856ä¸ªè¯„åˆ†
                ratingValue.textContent = newRating.toFixed(1);

                // å…³é—­æ¨¡æ€æ¡†
                document.getElementById('ratingModal').style.display = 'none';

                alert('è¯„åˆ†å·²æäº¤ï¼Œæ„Ÿè°¢æ‚¨çš„å‚ä¸ï¼');
            } else {
                alert('è¯·é€‰æ‹©è¯„åˆ†æ˜Ÿçº§ï¼');
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥çŠ¶æ€
        document.addEventListener('DOMContentLoaded', function () {
            // æ£€æŸ¥æ”¶è—çŠ¶æ€
            const favoriteBtn = document.querySelector('.stat-item:nth-child(3)');
            const isFavorited = localStorage.getItem('gameFavorited') === 'true';
            if (isFavorited) {
                favoriteBtn.querySelector('.stat-icon').textContent = 'â¤ï¸';
            }

            // æ£€æŸ¥è¯„åˆ†çŠ¶æ€
            const savedRating = localStorage.getItem('gameRating');
            if (savedRating) {
                const ratingValue = document.getElementById('ratingValue');
                ratingValue.textContent = savedRating;
            }

            // æ£€æŸ¥è¯„è®ºçŠ¶æ€å¹¶æ›´æ–°è¯„è®ºæ•°
            const savedComments = localStorage.getItem('gameComments');
            if (savedComments) {
                const commentCount = document.getElementById('commentCount');
                const comments = JSON.parse(savedComments);
                commentCount.textContent = comments.length;
            }
        });

        // æ‰“å¼€è¯„åˆ†æ¨¡æ€æ¡†
        function openRatingModal() {
            const isRated = localStorage.getItem('gameRated') === 'true';
            if (isRated) {
                alert('å·²ç»è¯„åˆ†è¿‡äº†ï¼');
                return;
            }

            const modal = document.getElementById('ratingModal');
            modal.style.display = 'flex';

            // åŠ è½½å·²ä¿å­˜çš„è¯„åˆ†
            const savedRating = localStorage.getItem('gameRating');
            if (savedRating) {
                const stars = document.querySelectorAll('.rating-star');
                stars.forEach(star => {
                    if (parseInt(star.dataset.value) <= savedRating) {
                        star.classList.add('active');
                    }
                });
            }
        }

        // æ‰“å¼€è¯„è®ºè®ºå›
        function openForum() {
            const forumModal = document.createElement('div');
            forumModal.className = 'forum-modal';

            // ä»localStorageåŠ è½½è¯„è®º
            let savedComments = [];
            try {
                const savedCommentsStr = localStorage.getItem('gameComments');
                if (savedCommentsStr) {
                    savedComments = JSON.parse(savedCommentsStr);
                }
            } catch (e) {
                console.error('åŠ è½½è¯„è®ºå¤±è´¥:', e);
            }

            // æ£€æŸ¥æ˜¯å¦éœ€è¦æ·»åŠ ç³»ç»Ÿé»˜è®¤è¯„è®º
            const hasSystemComments = savedComments.some(comment =>
                ['æ¸¸æˆç©å®¶', 'RPGçˆ±å¥½è€…', 'æ–°ç©å®¶', 'èµ„æ·±ç©å®¶', 'æ¸¸æˆè¯„è®ºå®¶'].includes(comment.author)
            );

            if (!hasSystemComments) {
                const systemComments = [
                    {
                        author: 'æ¸¸æˆç©å®¶',
                        date: '2023-06-15',
                        content: 'è¿™æ¬¾æ¸¸æˆçš„å‰§æƒ…éå¸¸ä¸°å¯Œï¼Œç”»é¢ä¹Ÿå¾ˆç²¾ç¾ã€‚ç‰¹åˆ«æ˜¯Håœºæ™¯çš„è®¾è®¡éå¸¸ç”¨å¿ƒï¼Œå¼ºçƒˆæ¨èï¼',
                        likes: 128,
                        liked: false,
                        replies: []
                    },
                    {
                        author: 'RPGçˆ±å¥½è€…',
                        date: '2023-06-10',
                        content: 'ä½œä¸ºä¸€ä¸ªRPGæ¸¸æˆï¼Œæˆ˜æ–—ç³»ç»Ÿè®¾è®¡å¾—ä¸é”™ï¼Œéš¾åº¦é€‚ä¸­ã€‚ä¸è¿‡æœ‰äº›æ”¯çº¿ä»»åŠ¡æ¯”è¾ƒéš¾æ‰¾ï¼Œå¸Œæœ›èƒ½æœ‰æ›´å¥½çš„å¼•å¯¼ã€‚',
                        likes: 96,
                        liked: false,
                        replies: []
                    },
                    {
                        author: 'æ–°ç©å®¶',
                        date: '2023-06-05',
                        content: 'ç¬¬ä¸€æ¬¡ç©è¿™ç§ç±»å‹çš„æ¸¸æˆï¼Œæ„Ÿè§‰å¾ˆæœ‰è¶£ï¼AIç¿»è¯‘çš„è´¨é‡ä¹Ÿä¸é”™ï¼Œç©èµ·æ¥å¾ˆæµç•…ã€‚',
                        likes: 75,
                        liked: false,
                        replies: []
                    },
                    {
                        author: 'èµ„æ·±ç©å®¶',
                        date: '2023-06-01',
                        content: 'æ¸¸æˆç”»é¢å¾ˆç²¾ç¾ï¼Œå‰§æƒ…ä¹Ÿå¾ˆå¸å¼•äººã€‚Håœºæ™¯çš„è®¾è®¡å¾ˆæœ‰åˆ›æ„ï¼Œå€¼å¾—ä¸€ç©ï¼',
                        likes: 112,
                        liked: false,
                        replies: []
                    },
                    {
                        author: 'æ¸¸æˆè¯„è®ºå®¶',
                        date: '2023-05-28',
                        content: 'RPGå…ƒç´ å’Œæˆäººå†…å®¹çš„å¹³è¡¡åšå¾—å¾ˆå¥½ï¼Œä¸ä¼šè®©äººè§‰å¾—çªå…€ã€‚æ¸¸æˆæ€§å¾ˆå¼ºï¼Œæ¨èç»™å–œæ¬¢RPGçš„ç©å®¶ã€‚',
                        likes: 89,
                        liked: false,
                        replies: []
                    }
                ];

                // å°†ç³»ç»Ÿè¯„è®ºæ·»åŠ åˆ°ç°æœ‰è¯„è®ºä¸­
                savedComments = [...systemComments, ...savedComments];
                localStorage.setItem('gameComments', JSON.stringify(savedComments));
            }

            // æ„å»ºè¯„è®ºåˆ—è¡¨HTML
            let commentsHTML = '';
            savedComments.forEach(comment => {
                commentsHTML += `
                    <div class="forum-post">
                        <div class="post-header">
                            <span class="post-author">${comment.author}</span>
                            <span class="post-date">${comment.date}</span>
                        </div>
                        <div class="post-content">
                            ${comment.content}
                        </div>
                        <div class="post-actions">
                            <button class="like-btn" data-liked="${comment.liked || 'false'}">ğŸ‘ ç‚¹èµ (${comment.likes || 0})</button>
                            <button class="reply-btn">ğŸ’¬ å›å¤</button>
                        </div>
                        <div class="replies" style="display: none;">
                            <div class="reply-form">
                                <textarea placeholder="å›å¤è¯„è®º..." class="reply-textarea"></textarea>
                                <button class="submit-reply">å‘é€å›å¤</button>
                            </div>
                            <div class="reply-list">
                                ${comment.replies ? comment.replies.map(reply => `
                                    <div class="reply-item">
                                        <div class="reply-header">
                                            <span class="reply-author">${reply.author}</span>
                                            <span class="reply-date">${reply.date}</span>
                                        </div>
                                        <div class="reply-content">
                                            ${reply.content}
                                        </div>
                                    </div>
                                `).join('') : ''}
                            </div>
                        </div>
                    </div>
                `;
            });

            forumModal.innerHTML = `
                <div class="forum-content">
                    <div class="forum-header">
                        <h3>æ¸¸æˆè¯„è®ºè®ºå›</h3>
                        <button class="close-forum">&times;</button>
                    </div>
                    <div class="forum-body">
                        <div class="forum-stats">
                            <div class="forum-stat">
                                <span class="stat-icon">ğŸ“</span>
                                <span class="stat-value">${savedComments.length}</span>
                                <span class="stat-label">æ€»è¯„è®ºæ•°</span>
                            </div>
                            <div class="forum-stat">
                                <span class="stat-icon">ğŸ‘¥</span>
                                <span class="stat-value">1.2K</span>
                                <span class="stat-label">æ´»è·ƒç”¨æˆ·</span>
                            </div>
                        </div>
                        <div class="forum-posts">
                            ${commentsHTML}
                        </div>
                        <div class="new-post">
                            <textarea placeholder="å‘è¡¨ä½ çš„è¯„è®º..." class="post-textarea"></textarea>
                            <button class="submit-post">å‘å¸ƒè¯„è®º</button>
                        </div>
                    </div>
                </div>
            `;

            // æ·»åŠ æ ·å¼
            const style = document.createElement('style');
            style.textContent = `
                .forum-modal {
                    display: flex;
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.8);
                    z-index: 1000;
                    justify-content: center;
                    align-items: center;
                }

                .forum-content {
                    background: var(--card-bg);
                    width: 90%;
                    max-width: 800px;
                    max-height: 90vh;
                    border-radius: var(--border-radius);
                    overflow: hidden;
                    display: flex;
                    flex-direction: column;
                }

                .forum-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 15px 20px;
                    background: var(--primary-color);
                    color: white;
                }

                .close-forum {
                    background: none;
                    border: none;
                    color: white;
                    font-size: 24px;
                    cursor: pointer;
                }

                .forum-body {
                    padding: 20px;
                    overflow-y: auto;
                }

                .forum-stats {
                    display: flex;
                    gap: 20px;
                    margin-bottom: 20px;
                }

                .forum-stat {
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    padding: 10px 15px;
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: var(--border-radius);
                }

                .forum-posts {
                    display: flex;
                    flex-direction: column;
                    gap: 15px;
                    margin-bottom: 20px;
                }

                .forum-post {
                    background: rgba(255, 255, 255, 0.1);
                    padding: 15px;
                    border-radius: var(--border-radius);
                }

                .post-header {
                    display: flex;
                    justify-content: space-between;
                    margin-bottom: 10px;
                    color: var(--primary-color);
                }

                .post-content {
                    margin-bottom: 10px;
                    line-height: 1.5;
                }

                .post-actions {
                    display: flex;
                    gap: 10px;
                }

                .post-actions button {
                    padding: 5px 10px;
                    border: none;
                    border-radius: 15px;
                    background: rgba(255, 255, 255, 0.1);
                    color: var(--text-color);
                    cursor: pointer;
                    transition: var(--transition);
                }

                .post-actions button:hover {
                    background: var(--primary-color);
                }

                .post-actions button.liked {
                    background: var(--primary-color);
                    color: white;
                }

                .replies {
                    margin-top: 15px;
                    padding-top: 15px;
                    border-top: 1px solid rgba(255, 255, 255, 0.1);
                }

                .reply-form {
                    margin-bottom: 15px;
                }

                .reply-textarea {
                    width: 100%;
                    height: 60px;
                    padding: 10px;
                    border: 1px solid var(--primary-color);
                    border-radius: var(--border-radius);
                    background: rgba(255, 255, 255, 0.1);
                    color: var(--text-color);
                    margin-bottom: 10px;
                    resize: vertical;
                }

                .submit-reply {
                    padding: 8px 15px;
                    background: var(--primary-color);
                    color: white;
                    border: none;
                    border-radius: 20px;
                    cursor: pointer;
                    transition: var(--transition);
                }

                .submit-reply:hover {
                    background: var(--secondary-color);
                }

                .reply-list {
                    display: flex;
                    flex-direction: column;
                    gap: 10px;
                }

                .reply-item {
                    background: rgba(255, 255, 255, 0.05);
                    padding: 10px;
                    border-radius: var(--border-radius);
                }

                .reply-header {
                    display: flex;
                    justify-content: space-between;
                    margin-bottom: 5px;
                    font-size: 0.9em;
                    color: var(--primary-color);
                }

                .reply-content {
                    font-size: 0.9em;
                    line-height: 1.4;
                }

                .new-post {
                    margin-top: 20px;
                }

                .post-textarea {
                    width: 100%;
                    height: 100px;
                    padding: 10px;
                    border: 1px solid var(--primary-color);
                    border-radius: var(--border-radius);
                    background: rgba(255, 255, 255, 0.1);
                    color: var(--text-color);
                    margin-bottom: 10px;
                    resize: vertical;
                }

                .submit-post {
                    padding: 10px 20px;
                    background: var(--primary-color);
                    color: white;
                    border: none;
                    border-radius: 20px;
                    cursor: pointer;
                    transition: var(--transition);
                }

                .submit-post:hover {
                    background: var(--secondary-color);
                }
            `;

            document.head.appendChild(style);
            document.body.appendChild(forumModal);

            // å…³é—­è®ºå›
            forumModal.querySelector('.close-forum').addEventListener('click', () => {
                document.body.removeChild(forumModal);
                document.head.removeChild(style);
            });

            // æäº¤è¯„è®º
            forumModal.querySelector('.submit-post').addEventListener('click', () => {
                const textarea = forumModal.querySelector('.post-textarea');
                const content = textarea.value.trim();

                if (content) {
                    const newComment = {
                        author: 'æˆ‘',
                        date: new Date().toISOString().split('T')[0],
                        content: content,
                        likes: 0,
                        liked: false,
                        replies: []
                    };

                    // æ›´æ–°localStorageä¸­çš„è¯„è®º
                    savedComments.unshift(newComment);
                    localStorage.setItem('gameComments', JSON.stringify(savedComments));

                    // æ›´æ–°è®ºå›å†…çš„è¯„è®ºæ•°
                    const forumCommentCount = forumModal.querySelector('.stat-value');
                    forumCommentCount.textContent = savedComments.length;

                    // æ›´æ–°é¡µé¢ä¸Šçš„è¯„è®ºæ•°
                    const pageCommentCount = document.getElementById('commentCount');
                    pageCommentCount.textContent = savedComments.length;

                    // é‡æ–°åŠ è½½è¯„è®ºåˆ—è¡¨
                    openForum();
                }
            });

            // è®¾ç½®ç‚¹èµå’Œå›å¤åŠŸèƒ½
            function setupPostEvents(post, commentIndex) {
                // ç‚¹èµåŠŸèƒ½
                const likeBtn = post.querySelector('.like-btn');
                likeBtn.addEventListener('click', function () {
                    if (this.dataset.liked === 'false') {
                        const count = parseInt(this.textContent.match(/\((\d+)\)/)[1]);
                        this.textContent = `ğŸ‘ ç‚¹èµ (${count + 1})`;
                        this.dataset.liked = 'true';
                        this.classList.add('liked');

                        // æ›´æ–°localStorageä¸­çš„ç‚¹èµçŠ¶æ€
                        savedComments[commentIndex].likes = count + 1;
                        savedComments[commentIndex].liked = true;
                        localStorage.setItem('gameComments', JSON.stringify(savedComments));
                    }
                });

                // å›å¤åŠŸèƒ½
                const replyBtn = post.querySelector('.reply-btn');
                const replies = post.querySelector('.replies');
                replyBtn.addEventListener('click', () => {
                    replies.style.display = replies.style.display === 'none' ? 'block' : 'none';
                });

                // æäº¤å›å¤
                const submitReply = post.querySelector('.submit-reply');
                submitReply.addEventListener('click', () => {
                    const textarea = post.querySelector('.reply-textarea');
                    const content = textarea.value.trim();

                    if (content) {
                        const newReply = {
                            author: 'æˆ‘',
                            date: new Date().toISOString().split('T')[0],
                            content: content
                        };

                        // æ›´æ–°localStorageä¸­çš„å›å¤
                        if (!savedComments[commentIndex].replies) {
                            savedComments[commentIndex].replies = [];
                        }
                        savedComments[commentIndex].replies.push(newReply);
                        localStorage.setItem('gameComments', JSON.stringify(savedComments));

                        // é‡æ–°åŠ è½½è¯„è®ºåˆ—è¡¨
                        openForum();
                    }
                });
            }

            // ä¸ºç°æœ‰è¯„è®ºè®¾ç½®äº‹ä»¶ç›‘å¬
            forumModal.querySelectorAll('.forum-post').forEach((post, index) => {
                setupPostEvents(post, index);
            });
        }
    </script>
</body>

</html>